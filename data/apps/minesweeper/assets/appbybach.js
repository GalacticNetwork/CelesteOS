!function(e) { var t = {}; function n(r) { if (t[r]) return t[r].exports; var a = t[r] = { i: r, l: !1, exports: {} }; return e[r].call(a.exports, a, a.exports, n), a.l = !0, a.exports } n.m = e, n.c = t, n.d = function(e, t, r) { n.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: r }) }, n.r = function(e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, n.t = function(e, t) { if (1 & t && (e = n(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var r = Object.create(null); if (n.r(r), Object.defineProperty(r, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var a in e) n.d(r, a, function(t) { return e[t] }.bind(null, a)); return r }, n.n = function(e) { var t = e && e.__esModule ? function() { return e.default } : function() { return e }; return n.d(t, "a", t), t }, n.o = function(e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, n.p = "", n(n.s = 12) }([function(e, t, n) { e.exports = { root: "Menu-root-16W-a", column: "Menu-column-3tWGo", columnActive: "Menu-columnActive-2Uy2Z Menu-column-3tWGo", button: "Menu-button-2Matj", menu: "Menu-menu-1-Jjw", item: "Menu-item-2hvvi", list: "Menu-list-_xxDe", option: "Menu-option-306gB", hotKey: "Menu-hotKey-2Ar8m", check: "Menu-check-1lHBd", separator: "Menu-separator-RQEZr" } }, function(e, t, n) { e.exports = { root: "CustomField-root-2OwRM", row: "CustomField-row-BllOa", name: "CustomField-name-1XC-k", value: "CustomField-value-2iCpl", footer: "CustomField-footer-18Fn6", button: "CustomField-button-geyKR" } }, function(e, t, n) { e.exports = { root: "Digit-root-18MJW", digit: "Digit-digit-mk2mM", t: "Digit-t-3ks06", rt: "Digit-rt-PDYa6", rb: "Digit-rb-2ZC6D", b: "Digit-b-3VLee", lb: "Digit-lb-3mDUV", lt: "Digit-lt-28Ugi", m: "Digit-m-ArDPw" } }, function(e, t, n) { e.exports = { a: "Dialog-a-2cbhB", b: "Dialog-b-3pRFV", dialog: "Dialog-dialog-2uAwv", container: "Dialog-container-3NIcF", header: "Dialog-header-1Jy3A", title: "Dialog-title-2crh1", button: "Dialog-button-12ici", close: "Dialog-close-1OajQ" } }, function(e, t, n) { e.exports = { root: "BestTime-root-2ZUb9", table: "BestTime-table-399aW", cell: "BestTime-cell-1JBBq", footer: "BestTime-footer-GIROL", button: "BestTime-button-3YslU" } }, function(e, t, n) { e.exports = { root: "Game-root-2Va_A", scoreboard: "Game-scoreboard-2zl3x", field: "Game-field-ZZOu5", active: "Game-active-34POm", inactive: "Game-inactive-2jAFT" } }, function(e, t, n) { e.exports = { root: "Cell-root-3iUnv", pressed: "Cell-pressed-1qb-_ Cell-root-3iUnv", image: "Cell-image-2S8IL", hurt: "Cell-hurt-3WVjB Cell-image-2S8IL" } }, function(e, t, n) { e.exports = { root: "Winner-root-2fVMQ", text: "Winner-text-2NeHI", input: "Winner-input-3FBe6", button: "Winner-button-3YIjF" } }, function(e, t, n) { e.exports = { root: "Play-root-2rx0x", down: "Play-down-3WpYz", up: "Play-up-r23N7", face: "Play-face-3m33y" } }, function(e, t, n) { e.exports = { root: "Overlay-root-2pdBR", table: "Overlay-table-3zUWK", cell: "Overlay-cell-18RrS" } }, function(e, t, n) { e.exports = { root: "Input-root-3Da8p", input: "Input-input-2DqDH" } }, function(e, t, n) { e.exports = { root: "Button-root-3V2xY" } }, function(e, t, n) { e.exports = n(14) }, function(e, t, n) { }, function(e, t, n) { "use strict"; function r(e, t) { for (var n = [], r = [], a = arguments.length; a-- > 2;)n.push(arguments[a]); for (; n.length;) { var l = n.pop(); if (l && l.pop) for (a = l.length; a--;)n.push(l[a]); else null != l && !0 !== l && !1 !== l && r.push(l) } return "function" == typeof e ? e(t || {}, r) : { nodeName: e, attributes: t || {}, children: r, key: t && t.key } } n.r(t); n(13); var a = n(5), l = n.n(a), o = n(3), i = n.n(o), u = n(11), s = n.n(u), c = function(e, t) { var n = e.key, a = e.type, l = e.tabIndex, o = e.onClick, i = e.onCreate; return r("button", { key: n, class: s.a.root, type: a, tabindex: l, onclick: o, oncreate: i }, t) }, m = function(e, t) { var n = e.key, a = e.title, l = e.onClose; return r("div", { key: n }, r("div", { class: i.a.a }, r("div", { class: i.a.b }, r("div", { class: i.a.dialog }, r("div", { class: i.a.container }, a && r("div", { class: i.a.header }, r("h1", { class: i.a.title }, a), l && r("div", { class: i.a.button }, r(c, { tabIndex: -1, onClick: l }, r("svg", { class: i.a.close, width: "13", height: "11" }, r("path", { d: "M10.977 2.406l-.883-.883L7 4.616 3.906 1.523l-.883.883L6.116 5.5 3.023 8.594l.883.883L7 6.384l3.094 3.093.883-.883L7.884 5.5l3.093-3.094z" }))))), t))))) }, f = n(0), d = n.n(f), v = function(e, t) { var n = e.key, a = e.name, l = e.hotKey, o = e.checked, i = e.onClick; return r("li", { key: n, class: d.a.item }, r("button", { type: "button", class: d.a.option, tabindex: -1, onclick: i }, o && r("svg", { class: d.a.check, width: "7", height: "7" }, r("path", { d: "M0 4.5L2.5 7 7 2.5V0L2.5 4.5 0 2v2.5z" })), a, l && r("span", { class: d.a.hotKey }, l)), t.length > 0 && r("div", { class: d.a.menu }, r("ul", { class: d.a.list }, t))) }, g = function(e, t) { var n = e.key, a = e.name, l = e.type, o = e.active, i = e.onChange; return r("li", { key: n, class: o && o[l] ? d.a.columnActive : d.a.column }, r("button", { type: "button", class: d.a.button, tabindex: -1, "data-name": l, onclick: i, onmouseenter: i }, a), t.length > 0 && r("div", { class: d.a.menu }, r("ul", { class: d.a.list }, t))) }, p = function() { return r("li", { class: d.a.separator }) }, h = function(e) { var t = e.state, n = e.actions; return r("ul", { class: d.a.root, tabindex: -1, onfocusout: n.toggleMenu }, r(g, { name: "Game", type: "game", active: t.menu, onChange: n.toggleMenu }, r(v, { name: "New", hotKey: "F2", onClick: function() { return n.reset() } }), r(p, null), r(v, { name: "Beginner", checked: "beginner" === t.game.level, onClick: function() { return n.reset({ level: "beginner" }) } }), r(v, { name: "Intermediate", checked: "intermediate" === t.game.level, onClick: function() { return n.reset({ level: "intermediate" }) } }), r(v, { name: "Expert", checked: "expert" === t.game.level, onClick: function() { return n.reset({ level: "expert" }) } }), r(v, { name: "Custom...", checked: "custom" === t.game.level, onClick: n.toggleCustomField }), r(p, null), r(v, { name: "Marks (?)", checked: t.marks, onClick: n.toggleMarks }), r(p, null), r(v, { name: "Best Times...", onClick: n.toggleBestTime }))) }, b = n(2), y = n.n(b), w = function(e) { var t = e.value; return r("div", { class: y.a.root }, ("00" + Math.max(-99, Math.min(999, t))).slice(-3).split("").sort(function(e) { return "-" === e ? -1 : 0 }).map(function(e) { return r("svg", { class: y.a.digit, width: "13", height: "23", "data-n": e }, r("path", { class: y.a.t, d: "M1.5 1l3 3h4l3-3h-10z" }), r("path", { class: y.a.rt, d: "M12 1.5l-3 3v4l3 3v-10z" }), r("path", { class: y.a.rb, d: "M12 11.5l-3 3v4l3 3v-10z" }), r("path", { class: y.a.b, d: "M11.5 22l-3-3h-4l-3 3h10z" }), r("path", { class: y.a.lb, d: "M1 21.5l3-3v-4l-3-3v10z" }), r("path", { class: y.a.lt, d: "M1 1.5v10l3-3v-4l-3-3z" }), r("path", { class: y.a.m, d: "M8.5 13h-4L3 11.5 4.5 10h4l1.5 1.5L8.5 13z" })) })) }, k = n(8), M = n.n(k), x = function() { return r("g", null, r("circle", { cx: "12", cy: "7", r: "1.5" }), r("circle", { cx: "7", cy: "7", r: "1.5" }), r("path", { d: "M13.779 11.1a.5.5 0 0 0-.7.1 4.455 4.455 0 0 1-7.158 0 .5.5 0 0 0-.8.6 5.455 5.455 0 0 0 8.752 0 .5.5 0 0 0-.094-.7z" })) }, C = function() { return r("g", null, r("circle", { cx: "12.5", cy: "6.5", r: "1.5" }), r("circle", { cx: "6.5", cy: "6.5", r: "1.5" }), r("path", { d: "M9.5 10a2.5 2.5 0 1 0 2.5 2.5A2.5 2.5 0 0 0 9.5 10zm0 4a1.5 1.5 0 1 1 1.5-1.5A1.5 1.5 0 0 1 9.5 14z" })) }, L = function() { return r("path", { d: "M12.227 12.188a5.067 5.067 0 0 1-5.454 0 .5.5 0 0 0-.546.837 5.981 5.981 0 0 0 6.546 0 .5.5 0 1 0-.546-.837zm4.627-3.042l-3-3A.5.5 0 0 0 13.5 6h-8a.5.5 0 0 0-.354.146l-3 3a.5.5 0 0 0 .708.708L5 7.707V9a1 1 0 0 0 1 1h1a2 2 0 0 0 2-2V7h1v1a2 2 0 0 0 2 2h1a1 1 0 0 0 1-1V7.707l2.146 2.147a.5.5 0 0 0 .708-.708z" }) }, T = function() { return r("path", { d: "M5.146 7.854a.5.5 0 0 0 .708 0l.646-.647.646.647a.5.5 0 0 0 .708-.708L7.207 6.5l.647-.646a.5.5 0 0 0-.708-.708l-.646.647-.646-.647a.5.5 0 0 0-.708.708l.647.646-.647.646a.5.5 0 0 0 0 .708zM13.207 6.5l.647-.646a.5.5 0 0 0-.708-.708l-.646.647-.646-.647a.5.5 0 0 0-.708.708l.647.646-.647.646a.5.5 0 0 0 .708.708l.646-.647.646.647a.5.5 0 0 0 .708-.708zM9.5 11a5.455 5.455 0 0 0-4.376 2.2.5.5 0 0 0 .8.6 4.455 4.455 0 0 1 7.158 0 .5.5 0 0 0 .8-.6A5.453 5.453 0 0 0 9.5 11z" }) }, F = function(e) { var t = e.pressed, n = e.win, a = e.lose; return r(t ? C : a ? T : n ? L : x, null) }, V = function(e) { var t = e.pressed, n = e.lose, a = e.win, l = e.onReset; return r("button", { class: M.a.root, type: "button", tabindex: -1, onclick: function() { return l() }, oncreate: function(e) { return e.focus() } }, r("svg", { class: M.a.face, width: "19", height: "19" }, r("circle", { cx: "9.5", cy: "9.5", r: "8.5", fill: "#ff0" }), r("path", { d: "M9.5 2A7.5 7.5 0 1 1 2 9.5 7.508 7.508 0 0 1 9.5 2m0-1A8.5 8.5 0 1 0 18 9.5 8.5 8.5 0 0 0 9.5 1z" }), r("g", { class: M.a.up }, r(F, { pressed: t, lose: n, win: a })), r("g", { class: M.a.down }, r(x, null)))) }, z = n(6), D = n.n(z), I = function(e, t, n, r) { return n >= 0 && r >= 0 && (e - n - 1) * (e - n + 1) <= 0 && (t - r - 1) * (t - r + 1) <= 0 }, A = function() { return r("path", { fill: "#00f", d: "M4 12v-2h2V6H4V5l3-3h2v8h2v2H4z" }) }, B = function() { return r("path", { fill: "#007b00", d: "M2 12h10v-2H6v-.5L11 7l1-1V3l-1-1H3L2 3v2h3V4h4v1L8 6 2 9v3z" }) }, O = function() { return r("path", { fill: "#f00", d: "M2 10h7V8H5V6h4V4H2V2h9l1 1v3l-1 1 1 1v3l-1 1H2v-2z" }) }, j = function() { return r("path", { fill: "#00007b", d: "M8 12h3V8h1V6h-1V2H8v4H5l2-4H4L2 6v2h6v4z" }) }, H = function() { return r("path", { fill: "#7b0000", d: "M2 2h10v2H5v2h6l1 1v4l-1 1H2v-2h7V8H2V2z" }) }, S = function() { return r("path", { fill: "#007b7b", d: "M11 6H5V4h6V2H3L2 3v8l1 1h8l1-1V7zm-2 4H5V8h4z" }) }, N = function() { return r("path", { d: "M2 2h10v4l-3 6H6l3-6V4H2V2z" }) }, E = function() { return r("path", { fill: "#7b7b7b", d: "M12 3l-1-1H3L2 3v3l1 1-1 1v3l1 1h8l1-1V8l-1-1 1-1zm-3 7H5V8h4zm0-4H5V4h4z" }) }, Y = function() { return r("g", { class: D.a.flag }, r("path", { d: "M9 10.5V3H8v7l-4 2v1h8v-1z" }), r("path", { fill: "#f00", d: "M9 3v5H8L4 5.5 8 3z" })) }, W = function() { return r("text", { x: "50%", y: "50%", dx: ".5", dy: ".4em", "text-anchor": "middle" }, "?") }, K = function() { return r("path", { fill: "#f00", d: "M13.854 1.854l-.708-.708L7.5 6.793 1.854 1.146l-.708.708L6.793 7.5l-5.647 5.646.708.708L7.5 8.207l5.646 5.647.708-.708L8.207 7.5l5.647-5.646z" }) }, _ = function() { return r("g", null, r("path", { d: "M13.5 7h-1.55A4.445 4.445 0 0 0 11 4.705l.741-.741a.5.5 0 1 0-.707-.707l-.74.743A4.446 4.446 0 0 0 8 3.05V1.5a.5.5 0 0 0-1 0v1.55A4.452 4.452 0 0 0 4.705 4l-.741-.741a.5.5 0 0 0-.707.707L4 4.705A4.452 4.452 0 0 0 3.05 7H1.5a.5.5 0 0 0 0 1h1.55A4.446 4.446 0 0 0 4 10.294l-.741.741a.5.5 0 0 0 .354.854.5.5 0 0 0 .353-.147L4.705 11A4.445 4.445 0 0 0 7 11.95v1.55a.5.5 0 0 0 1 0v-1.55a4.452 4.452 0 0 0 2.3-.95l.74.74a.5.5 0 0 0 .707-.707L11 10.3a4.452 4.452 0 0 0 .95-2.3h1.55a.5.5 0 0 0 0-1z" }), r("circle", { cx: "6", cy: "6", r: "1", fill: "#fff" })) }, P = function(e) { var t = e.opened, n = e.mined, a = e.flag, l = e.mark, o = e.num, i = e.lose; if (t) { if (n) return r(_, null); switch (o) { case 1: return r(A, null); case 2: return r(B, null); case 3: return r(O, null); case 4: return r(j, null); case 5: return r(H, null); case 6: return r(S, null); case 7: return r(N, null); case 8: return r(E, null); default: return null } } return a ? i && !n ? r("g", null, r(_, null), r(K, null)) : r(Y, null) : i && n ? r(_, null) : l ? r(W, null) : null }, X = function(e) { var t = e.x, n = e.y, a = e.pressed, l = e.pressedX, o = e.pressedY, i = e.group, u = e.opened, s = e.mined, c = e.flag, m = e.mark, f = e.num, d = e.lose, v = e.onDown, g = e.onMove, p = e.onTouch; return r("button", { type: "button", class: u || a && !c && l === t && o === n || i && !c && I(t, n, l, o) || d && (!c && s || c && !s) ? D.a.pressed : D.a.root, tabindex: -1, onmousedown: function(e) { v({ event: e, x: t, y: n }) }, onmouseenter: function() { g({ x: t, y: n }) }, onmouseleave: function() { g({ x: -1, y: -1 }) }, ontouchstart: function(e) { p({ event: e, x: t, y: n }) } }, r("svg", { class: u && s ? D.a.hurt : D.a.image, width: "15", height: "15" }, r(P, { opened: u, mined: s, flag: c, mark: m, num: f, lose: d }))) }, R = function(e) { var t = e.key, n = e.state, a = e.actions; return r(m, { key: t, title: "Minesweeper" }, r(h, { state: n, actions: a }), r("div", { class: l.a.root }, r("div", { class: l.a.scoreboard }, r(w, { value: n.game.flags }), r(V, { pressed: n.game.pressed, lose: n.game.lose, win: n.game.win, onReset: a.reset }), r(w, { value: n.game.time })), r("div", { class: l.a.field }, n.game.field.map(function(e, t) { return r("div", { class: n.game.win || n.game.lose ? l.a.inactive : l.a.active }, e.map(function(e, l) { return r(X, { x: l, y: t, pressed: n.game.pressed, pressedX: n.game.pressedX, pressedY: n.game.pressedY, group: n.game.group, opened: e.opened, mined: e.mined, flag: e.flag, mark: e.mark, num: e.num, lose: n.game.lose, onDown: a.down, onMove: a.move, onTouch: a.touch }) })) })))) }, G = n(7), U = n.n(G), Z = n(9), q = n.n(Z), J = function(e, t) { var n = e.key, a = e.onKeyDown; return r("section", { key: n, class: q.a.root, tabindex: -1, onkeydown: a }, r("div", { class: q.a.table }, r("div", { class: q.a.cell }, t))) }, Q = n(10), $ = n.n(Q), ee = function(e) { var t = e.key, n = e.id, a = e.type, l = e.name, o = e.value, i = e.maxLength, u = e.inputMode, s = e.onInput, c = e.onCreate; return r("span", { class: $.a.root }, r("input", { key: t, id: n, class: $.a.input, type: a || "text", name: l, value: o, maxlength: i, inputmode: u, oninput: s, oncreate: c })) }, te = function(e) { var t = e.key, n = e.state, a = e.actions; return r(J, { key: t }, r(m, null, r("form", { class: U.a.root, autocomplete: "off", onsubmit: a.submitBestTime }, r("label", { for: "winner", class: U.a.text }, "You have the fastest time for ", n.level, " level."), r("label", { for: "winner", class: U.a.text }, "Please enter your name."), r("div", { class: U.a.input }, r(ee, { id: "winner", name: "winner", value: n.name, maxLength: 32, inputMode: "latin-name", onInput: function(e) { return a.changeWinner({ name: e.target.value }) }, onCreate: function(e) { e.focus(), e.select() } })), r(c, null, r("span", { class: U.a.button }, "OK"))))) }, ne = n(4), re = n.n(ne), ae = function(e) { var t = e.key, n = e.state, a = e.actions; return r(J, { key: t, onKeyDown: function(e) { return 27 === e.keyCode && a.toggleBestTime() } }, r(m, { title: "Fastest Mine Sweepers", onClose: a.toggleBestTime }, r("div", { class: re.a.root }, r("table", { class: re.a.table }, r("tbody", null, n.levels.map(function(e) { return r("tr", null, r("td", { class: re.a.cell }, e.level, ":"), r("td", { class: re.a.cell }, e.time, " seconds"), r("td", { class: re.a.cell }, e.name)) }))), r("div", { class: re.a.footer }, r(c, { type: "button", onClick: a.resetBestTime }, r("span", { class: re.a.button }, "Reset Scores")), r(c, { type: "button", onClick: a.toggleBestTime, onCreate: function(e) { return e.focus() } }, r("span", { class: re.a.button }, "OK")))))) }, le = n(1), oe = n.n(le), ie = function(e) { var t = e.key, n = e.state, a = e.actions; return r(J, { key: t, onKeyDown: function(e) { return 27 === e.keyCode && a.toggleCustomField() } }, r(m, { title: "Custom Field", onClose: a.toggleCustomField }, r("form", { class: oe.a.root, autocomplete: "off", onsubmit: a.submitCustomField }, r("div", null, r("label", { class: oe.a.row }, r("span", { class: oe.a.name }, "Height: "), r("span", { class: oe.a.value }, r(ee, { value: n.height, maxLength: 5, inputMode: "numeric", onInput: function(e) { return a.changeCustomField({ height: e.target.value }) } }))), r("label", { class: oe.a.row }, r("span", { class: oe.a.name }, "Width: "), r("span", { class: oe.a.value }, r(ee, { value: n.width, maxLength: 5, inputMode: "numeric", onInput: function(e) { return a.changeCustomField({ width: e.target.value }) } }))), r("label", { class: oe.a.row }, r("span", { class: oe.a.name }, "Mines: "), r("span", { class: oe.a.value }, r(ee, { value: n.mines, maxLength: 5, inputMode: "numeric", onInput: function(e) { return a.changeCustomField({ mines: e.target.value }) } })))), r("div", { class: oe.a.footer }, r(c, { onCreate: function(e) { return e.focus() } }, r("span", { class: oe.a.button }, "OK")), r(c, { type: "button", onClick: a.toggleCustomField }, r("span", { class: oe.a.button }, "Cancel")))))) }, ue = { beginner: { level: "beginner", width: 9, height: 9, mines: 10 }, intermediate: { level: "intermediate", width: 16, height: 16, mines: 40 }, expert: { level: "expert", width: 30, height: 16, mines: 99 } }, se = Object.keys(ue), ce = "undefined" != typeof window, me = function(e) { for (var t = e.level, n = e.width, r = e.height, a = e.mines, l = new Array(r), o = 0, i = a; o < r; o++) { l[o] = new Array(n); for (var u = 0; u < n; u++, i--)l[o][u] = { opened: !1, mined: i > 0, flag: !1, mark: !1, num: 0 } } return { level: t, width: n, height: r, mines: a, field: l, left: n * r - a, pressed: !1, pressedX: -1, pressedY: -1, group: !1, flags: a, start: -1, time: 0, raf: null, lose: !1, win: !1, touch: !1 } }, fe = function(e, t, n) { var r = e.field[n][t]; if (r.opened) { for (var a = 0, l = -1; l <= 1; l++)for (var o = -1; o <= 1; o++) { var i = l + t, u = o + n; i >= 0 && u >= 0 && i < e.width && u < e.height && (a += e.field[u][i].flag ? 1 : 0) } return a === r.num } return !1 }, de = function(e, t, n) { return n(e - 1, t - 1) + n(e - 1, t + 1) + n(e + 1, t - 1) + n(e + 1, t + 1) + n(e - 1, t) + n(e + 1, t) + n(e, t - 1) + n(e, t + 1) }, ve = function(e, t) { var n = Math.max(9, Math.min(40, parseInt(e.width, 10) || t.width)), r = Math.max(9, Math.min(30, parseInt(e.height, 10) || t.height)), a = parseInt(e.mines, 10) || t.mines; return { level: "custom", width: n, height: r, mines: Math.max(10, Math.min(Math.floor(n * r * .8), a)) } }, ge = function(e) { return e.preventDefault(), !1 }, pe = { destroy: !1, menu: null, game: me(function() { if (ce) { var e = localStorage.getItem("level"); if ("string" == typeof e) { if (ue[e]) return ue[e]; var t = e.split(","); return ve({ width: t[0], height: t[1], mines: t[2] }, ue.beginner) } } return ue.beginner }()), marks: !!ce && Boolean(localStorage.getItem("marks")), winner: null, bestTime: null, customField: null }, he = { getState: function() { return function(e) { return e } }, init: function() { return function(e, t) { window.addEventListener("keydown", t.press) } }, destroy: function() { return function(e, t) { return window.removeEventListener("keydown", t.press), { destroy: !0 } } }, press: function(e) { return function(t, n) { 113 !== e.keyCode && 78 !== e.keyCode || n.reset() } }, reset: function(e) { return function(t) { var n = t.game; cancelAnimationFrame(n.raf); var r = e && ue[e.level] || e || n; return window.gtag("event", r.level === n.level ? "reset" : "level", { event_category: "game", event_label: r.level }), localStorage.setItem("level", "custom" === r.level ? [r.width, r.height, r.mines].join() : r.level), { menu: null, game: me(r) } } }, touch: function(e) { var t = e.event, n = e.x, r = e.y; return function(e, a) { var l = e.game; if (l.win || l.lose) return null; var o = t.currentTarget.getBoundingClientRect(), i = setTimeout(a.flag, 600), u = function(e) { var t = e.touches; (!t || 1 !== t.length || t[0].clientX < o.left || t[0].clientX > o.right || t[0].clientY < o.top || t[0].clientY > o.bottom) && (clearTimeout(i), a.move({ x: -1, y: -1 })) }, s = function e(t) { var n = t.changedTouches; clearTimeout(i), window.removeEventListener("scroll", u), window.removeEventListener("touchmove", u), window.removeEventListener("touchend", e), window.removeEventListener("touchcancel", e), u({ touches: n }), a.up() }; return window.addEventListener("scroll", u), window.addEventListener("touchmove", u), window.addEventListener("touchend", s), window.addEventListener("touchcancel", s), { game: Object.assign({}, l, { pressed: !0, pressedX: n, pressedY: r, group: t.shiftKey || fe(l, n, r), touch: !0 }) } } }, flag: function() { return function(e) { var t = e.game, n = e.marks, r = t.pressedX, a = t.pressedY, l = t.field, o = t.flags; if (r < 0 || a < 0) return null; var i = l[a][r]; if (i.opened) return null; var u = t.field.slice(); u[a] = u[a].slice(); var s = Object.assign({}, i, { flag: n ? !i.mark && !i.flag : !i.flag, mark: n && i.flag }); u[a][r] = s; var c = i.flag === s.flag ? o : o + (s.flag ? -1 : 1); return { game: Object.assign({}, t, { field: u, flags: c, pressedX: -1, pressedY: -1 }) } } }, down: function(e) { var t = e.event, n = e.x, r = e.y; return function(e, a) { var l = e.game, o = e.marks; if (l.touch || t.button > 2 || l.win || l.lose) return null; window.addEventListener("mouseup", a.up); var i = l.field, u = l.flags, s = i[r][n]; if (!l.pressed && 2 === t.button && !i[r][n].opened) { (i = i.slice())[r] = i[r].slice(); var c = Object.assign({}, s, { flag: o ? !s.mark && !s.flag : !s.flag, mark: o && s.flag }); i[r][n] = c, u = s.flag === c.flag ? u : u + (c.flag ? -1 : 1) } return { game: Object.assign({}, l, { field: i, pressed: 2 !== t.button, pressedX: n, pressedY: r, group: t.shiftKey || t.buttons > 2, flags: u }) } } }, move: function(e) { var t = e.x, n = e.y; return function(e) { var r = e.game; return t === r.pressedX && n === r.pressedY ? null : { game: Object.assign({}, r, { pressedX: t, pressedY: n }) } } }, up: function() { return function(e, t) { var n = e.game; window.removeEventListener("mouseup", t.up); var r = n.width, a = n.height, l = n.pressedX, o = n.pressedY; if (n.win || n.lose || l < 0 || o < 0) return n.pressed || n.group ? { game: Object.assign({}, n, { pressed: !1, group: !1 }) } : null; var i = n.field.map(function(e) { return e.map(function(e) { return Object.assign({}, e) }) }), u = function(e, t) { return e < 0 || t < 0 || e >= r || t >= a }, s = function(e, t, n) { for (var r = 0, a = -1; a <= 1; a++)for (var l = -1; l <= 1; l++)u(a + e, l + t) || (r += n(i[l + t][a + e]) ? 1 : 0); return r }, c = n.left, m = n.lose, f = function e(t, n) { if (u(t, n)) return 0; var r = i[n][t]; return r.opened || r.flag ? 0 : (r.opened = !0, r.num = s(t, n, function(e) { return e.mined }), r.mined && (m = !0), r.num ? 1 : de(t, n, e) + 1) }, d = n.start < 0; if (d) { for (var v = a * r - 2; v > 0; v--) { var g = Math.floor(Math.random() * (v + 1)), p = i[Math.floor(v / r)][v % r], h = i[Math.floor(g / r)][g % r], b = p.mined; p.mined = h.mined, h.mined = b } var y = i[a - 1][r - 1], w = i[o][l], k = y.mined; y.mined = w.mined, w.mined = k, n.raf = requestAnimationFrame(t.tick), window.gtag("event", "start", { event_category: "game", event_label: n.level }) } var M = i[o][l]; n.group ? M.opened && s(l, o, function(e) { return e.flag }) === M.num && (c -= de(l, o, f)) : n.pressed && (c -= f(l, o)); var x = c <= 0; return (x || m) && (cancelAnimationFrame(n.raf), m || t.win(), window.gtag("event", m ? "lose" : "win", { event_category: "game", event_label: n.level, value: n.time })), { game: Object.assign({}, n, { left: c, field: i, pressed: !1, group: !1, start: d ? performance.now() : n.start, time: d ? 1 : n.time, lose: m, win: x, touch: !1 }) } } }, tick: function(e) { return function(t, n) { var r = t.game; r.raf = requestAnimationFrame(n.tick); var a = Math.floor((e - r.start) / 1e3) + 1; return r.time === a ? null : { game: Object.assign({}, r, { time: a }) } } }, win: function() { return function(e) { var t = e.game; if ("custom" === t.level) return null; var n = parseInt(localStorage.getItem(t.level), 10); return n && n <= t.time ? null : { winner: { name: "Anonymous", time: t.time, level: t.level } } } }, changeWinner: function(e) { return function(t) { var n = t.winner; return { winner: Object.assign({}, n, e) } } }, submitBestTime: function(e) { return function(t, n) { var r = t.winner; return e.preventDefault(), localStorage.setItem(r.level, r.time), localStorage.setItem(r.level + "Name", r.name.trim()), n.toggleBestTime(), { winner: null } } }, toggleBestTime: function() { return function(e) { return { menu: null, bestTime: e.bestTime ? null : { levels: se.map(function(e) { return { level: e, name: localStorage.getItem(e + "Name") || "Anonymous", time: Math.min(999, parseInt(localStorage.getItem(e), 10) || 0) || 999 } }) } } } }, resetBestTime: function() { return { bestTime: { levels: se.map(function(e) { return { level: e, name: localStorage.removeItem(e + "Name") || "Anonymous", time: localStorage.removeItem(e) || 999 } }) } } }, toggleCustomField: function() { return function(e) { var t = e.game; return { menu: null, customField: e.customField ? null : { width: String(t.width), height: String(t.height), mines: String(t.mines) } } } }, changeCustomField: function(e) { return function(t) { var n = t.customField; return { customField: Object.assign({}, n, e) } } }, submitCustomField: function(e) { return function(t, n) { var r = t.game, a = t.customField; return e.preventDefault(), n.reset(ve(a, r)), { customField: null } } }, toggleMarks: function() { return function(e) { var t = !e.marks; return localStorage.setItem("marks", t ? "yes" : ""), { menu: null, marks: t } } }, toggleMenu: function(e) { return function(t) { var n, r, a = t.menu, l = e.currentTarget.dataset.name; return "click" === e.type ? { menu: a && a[l] ? null : (n = {}, n[l] = !0, n) } : "mouseenter" === e.type ? a ? { menu: (r = {}, r[l] = !0, r) } : null : "focusout" !== e.type || e.currentTarget.contains(e.relatedTarget) ? null : { menu: null } } } }; window.app = function(e, t, n, r) { var a, l = [].map, o = r && r.children[0] || null, i = o && function e(t) { return { nodeName: t.nodeName.toLowerCase(), attributes: {}, children: l.call(t.childNodes, function(t) { return 3 === t.nodeType ? t.nodeValue : e(t) }) } }(o), u = [], s = !0, c = g(e), m = function e(t, n, r) { for (var a in r) "function" == typeof r[a] ? function(e, a) { r[e] = function(e) { var l = a(e); return "function" == typeof l && (l = l(h(t, c), r)), l && l !== (n = h(t, c)) && !l.then && v(c = p(t, g(n, l), c)), l } }(a, r[a]) : e(t.concat(a), n[a] = g(n[a]), r[a] = g(r[a])); return r }([], c, g(t)); return v(), m; function f(e) { return "function" == typeof e ? f(e(c, m)) : null != e ? e : "" } function d() { a = !a; var e = f(n); for (r && !a && (o = function e(t, n, r, a, l) { if (a === r); else if (null == r || r.nodeName !== a.nodeName) { var o = function e(t, n) { var r = "string" == typeof t || "number" == typeof t ? document.createTextNode(t) : (n = n || "svg" === t.nodeName) ? document.createElementNS("http://www.w3.org/2000/svg", t.nodeName) : document.createElement(t.nodeName), a = t.attributes; if (a) { a.oncreate && u.push(function() { a.oncreate(r) }); for (var l = 0; l < t.children.length; l++)r.appendChild(e(t.children[l] = f(t.children[l]), n)); for (var o in a) w(r, o, a[o], null, n) } return r }(a, l); t.insertBefore(o, n), null != r && k(t, n, r), n = o } else if (null == r.nodeName) n.nodeValue = a; else { !function(e, t, n, r) { for (var a in g(t, n)) n[a] !== ("value" === a || "checked" === a ? e[a] : t[a]) && w(e, a, n[a], t[a], r); var l = s ? n.oncreate : n.onupdate; l && u.push(function() { l(e, t) }) }(n, r.attributes, a.attributes, l = l || "svg" === a.nodeName); for (var i = {}, c = {}, m = [], d = r.children, v = a.children, p = 0; p < d.length; p++) { m[p] = n.childNodes[p]; var h = b(d[p]); null != h && (i[h] = [m[p], d[p]]) } for (var p = 0, y = 0; y < v.length;) { var h = b(d[p]), M = b(v[y] = f(v[y])); if (c[h]) p++; else if (null == M || M !== b(d[p + 1])) if (null == M || s) null == h && (e(n, m[p], d[p], v[y], l), y++), p++; else { var x = i[M] || []; h === M ? (e(n, x[0], x[1], v[y], l), p++) : x[0] ? e(n, n.insertBefore(x[0], m[p]), x[1], v[y], l) : e(n, m[p], null, v[y], l), c[M] = v[y], y++ } else null == h && k(n, m[p], d[p]), p++ } for (; p < d.length;)null == b(d[p]) && k(n, m[p], d[p]), p++; for (var p in i) c[p] || k(n, i[p][0], i[p][1]) } return n }(r, o, i, i = e)), s = !1; u.length;)u.pop()() } function v() { a || (a = !0, setTimeout(d)) } function g(e, t) { var n = {}; for (var r in e) n[r] = e[r]; for (var r in t) n[r] = t[r]; return n } function p(e, t, n) { var r = {}; return e.length ? (r[e[0]] = e.length > 1 ? p(e.slice(1), t, n[e[0]]) : t, g(n, r)) : t } function h(e, t) { for (var n = 0; n < e.length;)t = t[e[n++]]; return t } function b(e) { return e ? e.key : null } function y(e) { return e.currentTarget.events[e.type](e) } function w(e, t, n, r, a) { if ("key" === t); else if ("style" === t) if ("string" == typeof n) e.style.cssText = n; else for (var l in "string" == typeof r && (r = e.style.cssText = ""), g(r, n)) { var o = null == n || null == n[l] ? "" : n[l]; "-" === l[0] ? e.style.setProperty(l, o) : e.style[l] = o } else "o" === t[0] && "n" === t[1] ? (t = t.slice(2), e.events ? r || (r = e.events[t]) : e.events = {}, e.events[t] = n, n ? r || e.addEventListener(t, y) : e.removeEventListener(t, y)) : t in e && "list" !== t && "type" !== t && "draggable" !== t && "spellcheck" !== t && "translate" !== t && !a ? e[t] = null == n ? "" : n : null != n && !1 !== n && e.setAttribute(t, n), null != n && !1 !== n || e.removeAttribute(t) } function k(e, t, n) { function r() { e.removeChild(function e(t, n) { var r = n.attributes; if (r) { for (var a = 0; a < n.children.length; a++)e(t.childNodes[a], n.children[a]); r.ondestroy && r.ondestroy(t) } return t }(t, n)) } var a = n.attributes && n.attributes.onremove; a ? a(t, r) : r() } }(pe, he, function(e, t) { return e.destroy ? null : r("main", { oncontextmenu: ge, ondragstart: ge, oncreate: t.init }, e.game && r(R, { key: "a", state: e, actions: t }), e.winner && r(te, { key: "b", state: e.winner, actions: t }), e.bestTime && r(ae, { key: "c", state: e.bestTime, actions: t }), e.customField && r(ie, { key: "d", state: e.customField, actions: t })) }, document.getElementById("app")), "serviceWorker" in navigator && navigator.serviceWorker.register("service-worker.js") }]);
//# sourceMappingURL=app.d8c76fda.js.map